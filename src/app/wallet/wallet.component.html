<div class="container root-content-container">
    <p class="col-12 mt-3 mb-lg-4 page-title text-uppercase page-title">
        <i class="fas fa-long-arrow-alt-left mr-3"></i>
        WALLET
    </p>

    <ng-container *ngIf="{ wallet: wallet$ | async } as states">
        <div *ngIf="states.wallet?.state === walletState.EMPTY" class="row">
            <div class="content-left col-12 col-lg-6 mt-4 pl-md-5 pr-md-5">
                <div class="wallet-warning mt-5 mb-5">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    You must initialize your wallet to invest
                </div>
                <div>
                    <h4 class="mb-3 text-uppercase">
                        Your private, secure wallet
                    </h4>
                    <p>
                        We're commited to making sure your funds are as safe as they can possibly be when
                        using our platform. <br> To do this, we prevent the management of your money by anyone
                        other than you.
                    </p>
                    <P>
                        This is why we use a third-party secure wallet to store
                        your money and approve investments into projects. To start
                        the process of initializing your wallet - click on the button below.
                    </P>

                </div>
                <div class="mt-4 text-center initialize-button">
                    <button (click)="setUpArkane()" class="btn btn-primary mt-3 w-100">
                        <i class="fas fa-plus mr-3"></i>
                        Initialize secure wallet
                    </button>
                </div>
            </div>

            <div class="content-right col-12 col-lg-5 mt-lg-4">
                <svg width="1.2em" height="1.2em" viewBox="0 0 16 16" class="bi bi-lightning-fill mr-3"
                     fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd"
                          d="M11.251.068a.5.5 0 0 1 .227.58L9.677 6.5H13a.5.5 0 0 1 .364.843l-8 8.5a.5.5 0 0 1-.842-.49L6.323 9.5H3a.5.5 0 0 1-.364-.843l8-8.5a.5.5 0 0 1 .615-.09z"/>
                </svg>
                <div>
                    <p>
                        <span>Advanced users</span>
                        <br>
                        This platform is powered by blockchain technology. A "wallet" is
                        a keystorage service used for signing transactions. If you're an advanced user and
                        would like to sign transactions yourself, <u>click here</u>
                    </p>

                </div>
            </div>
        </div>

        <div *ngIf="!!states.wallet && states.wallet.state !== walletState.EMPTY else overlaySpinner" class="">
            <div class="row">
                <div class="col-md-12">
                    <div *ngIf="states.wallet?.wallet?.balance === 0" class="alert alert-info w-100 mt-4">
                        Your wallet is empty. Deposit funds to get started!
                    </div>
                </div>

                <div class="col-lg-12  text-center text-md-left  mt-4 ">
                    <div class="wallet-balance d-md-flex align-items-center pt-4 pb-4 pl-2">
                        <div class="col-12 col-md-6 col-xl-8 balance-left">
                            <span class="h1">
                                <div class="balance-text text-uppercase mb-2">Balance</div>
                                <div class="balance-amount">
                                    {{ states.wallet?.wallet?.balance | currencyCents }}
                                </div>
                            </span>
                        </div>
                        <div class="col-12 col-md-3 col-xl-2 mt-4 mt-md-0 button-container">
                            <button class="btn btn-primary w-100" routerLink="deposit"
                                    [disabled]="states.wallet.state !== walletState.READY">
                                <i class="fas fa-arrow-circle-down mr-2"></i>
                                Deposit
                            </button>
                        </div>
                        <div class="col-12 col-md-3 col-xl-2 mt-4 mt-md-0 button-container">
                            <button class="btn btn-primary w-100" routerLink="withdraw"
                                    [disabled]="states.wallet.state !== walletState.READY">
                                <i class="fas fa-arrow-circle-up mr-2"></i>
                                Withdraw
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <div class="col-md-12 mt-3 mb-5" *ngIf="states.wallet.state === walletState.READY">
					<span class="h4 text-left">
						<div class="explainer-mini float-right mb-2 w-100">Transaction History</div>
					</span>
                <ng-container *ngIf="(transactionHistory$ | async) else overlaySpinner">
                    <div *ngIf="transactionHistory !== undefined" class="wow fadeIn">
                        <table class="table table-striped">
                            <tbody>
                            <tr *ngFor="let transaction of transactionHistoryPage">
                                <td class="icon-type-cell pr-0">
                                <span class="icon-type">
                                    <i class="fas mr-3 {{ transaction.type | txIconType }}"></i>
                                </span>
                                </td>
                                <td class="pl-1">
                                    <div>
                                    <span>
                                        <div>{{ transaction.type }}</div>
                                        {{ transaction.date | date:'medium' }}
                                    </span>
                                    </div>
                                </td>
                                <td *ngIf="transaction.state != 'MINED'">
                                    <i class="icon-type fas {{ transaction.state | txIconStatus }}"></i>
                                </td>
                                <td>
                                    <div class="currency-table-column">
                                        {{ transaction.type | txAmountSign }} {{ transaction.amount | currencyCents }}
                                    </div>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="d-flex justify-content-center p-2">
                            <ngb-pagination [collectionSize]="transactionItems" [(page)]="tablePage"
                                            [pageSize]="tablePageSize"
                                            (pageChange)="refreshTransactionHistory()">
                            </ngb-pagination>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>
    </ng-container>

    <ng-template #overlaySpinner>
        <div class="justify-content-center" style="width: 100%">
            <app-spinner type="overlay"></app-spinner>
        </div>
    </ng-template>
</div>
