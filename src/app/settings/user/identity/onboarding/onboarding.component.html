<div>
    <ng-container *ngIf="(session$ | async) as session; else spinner">
        <div *ngIf="showDecision(session)" class="mt-3 text-center">
            <h2 *ngIf="session.decision.status === decisionStatus.RESUBMISSION_REQUESTED">
                {{ 'settings.user.identity.onboarding.resubmission_requested' | translate }}
            </h2>

            <h2 *ngIf="session.decision.status === decisionStatus.DECLINED">
                {{ 'settings.user.identity.onboarding.declined' | translate }}
            </h2>

            <!-- TODO: replace decision reason with translations of reason codes -->
            <p class="mt-1">{{ session.decision.reason }}</p>
        </div>

        <div *ngIf="decisionPending(session)" class="mt-3">
            <p class="text-center">
                {{ 'settings.user.identity.onboarding.decision_pending' | translate }}
            </p>
        </div>

        <div *ngIf="!decisionPending(session)" class="d-flex justify-content-center mt-3">
            <form [formGroup]="startVerificationForm">
                <div [hidden]="!appConfig.config.config?.coop_statute_url">
                    <label for="google-client-id" class="app-page-label mt-3">
                        {{ 'settings.user.identity.onboarding.statute_confirmation_input.title' | translate }}
                    </label>
                    <div class="d-flex align-items-center">
                        <input class="form-control w-auto h-auto m-2" id="google-client-id"
                               formControlName="statute_confirmation"
                               type="checkbox">
                        <small>
                       <span>
                            {{ 'settings.user.identity.onboarding.statute_confirmation_input.notice' | translate | splitPart:0 }}
                       </span>
                            <span class="d-inline-flex">
                            <a href="{{ appConfig.config.config?.coop_statute_url }}" target="_blank"
                               rel="noopener noreferrer">
                                {{ 'settings.user.identity.onboarding.statute_confirmation_input.notice'
                                    | translate | splitPart:1 | interpolate:['coopName', appConfig.config.name] }}
                            </a>
                       </span>
                            <span>
                            {{ 'settings.user.identity.onboarding.statute_confirmation_input.notice' | translate | splitPart:2 }}
                       </span>
                        </small>
                    </div>
                </div>

                <button app-action-button
                        class="btn btn-primary w-auto mx-auto my-3"
                        [disabled]="!startVerificationForm.valid"
                        [onClick]="createVeriffFrame(session.verification_url)"
                        text="{{ 'settings.user.identity.onboarding.start_verification' | translate }}">
                </button>
            </form>
        </div>
    </ng-container>

    <ng-container *ngIf="approved$ | async"></ng-container>
    <ng-template #spinner>
        <app-spinner type="overlay"></app-spinner>
    </ng-template>
</div>
